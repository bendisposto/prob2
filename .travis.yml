language: java
jdk:
- oraclejdk8
before_install:
- openssl aes-256-cbc -pass pass:$ENCRYPTION_PASSWORD -in secring.gpg.enc -out secring.gpg
  -d
- openssl aes-256-cbc -pass pass:$ENCRYPTION_PASSWORD -in pubring.gpg.enc -out pubring.gpg
  -d
- openssl aes-256-cbc -pass pass:$ENCRYPTION_PASSWORD -in gradle.properties.enc -out
  de.prob2.kernel/gradle.properties -d
branches:
  only:
  - master
  - develop
addons:
  sonarqube:
    branches:
    - master
    - develop
sudo: false
install: "/bin/true"
script:
  - TERM=dumb ./de.prob2.kernel/gradlew -b de.prob2.kernel/build.gradle clean test integrationtests --stacktrace
  - sonar-scanner -Dsonar.login=$SONAR_TOKEN

after_success:
- TERM=dumb ./de.prob2.kernel/gradlew -b de.prob2.kernel/build.gradle uploadArchives
env:
  global:
  - GRADLE_OPTS="-Xms128m"
  - secure: DtyDUbGXZOZzuYWvCnL8eSaKpM6fQXQqnDBQzwD5OoBaCv6S3ijGHvNmie2tGTe5c93siiRU/doaJNH5PN6JN8Fbw+nxBJRIzKpqjVFmLPy2hCwPXum1BI4Nsf4vH4fZ4eENK1mFUDUR4MWrTAk9Vl05jIjEvsNlkrusBnVWFmg=
  - secure: CzvIhQI58TrL9egcS8Mv9JwxczwxhghuOR81EcD1H0lzt5U0bzNWYgRlBv2gntVg9Rv7O5eIOEcvc03lYRgIRbMfNsFDmJwne3CoCdYq7CpXyiQMWLo/C9NEzVIEKBZMIZ+/nx5MJsdG7fqjT/PzNJi43/jOtZSWbnWp8kNvbTM=
  #SONAR_TOKEN
  - secure: dq8np+Dwxk6Xh0ZPYw5+kxnCyEVQ/riByjNFYkaUQH4BuZhpEd7Gd6f/bdB0vb2ZKtAfrwoIKnSmE0bpvyCaJ+GoB12uqEGsbO7t3v/2cdeWGM6LAQxgzm3P4zRdMFOW4qWgtS+KIVWOJbD3z/DUWU83MDqDUL52TDr+F6drSmQ=
